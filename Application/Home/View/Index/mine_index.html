<!DOCTYPE html>
<html lang="en">
<head>

    <!-- start: Meta -->
    <meta charset="utf-8">
    <title>ACME Dashboard - Perfect Bootstrap Admin Template</title>
    <meta name="description" content="ACME Dashboard Bootstrap Admin Template.">
    <meta name="author" content="Łukasz Holeczek">
    <meta name="keyword" content="ACME, Dashboard, Bootstrap, Admin, Template, Theme, Responsive, Fluid, Retina">
    <!-- end: Meta -->

    <include file="./Application/Home/View/Index/header_include.html"/>

</head>
<body>

<include file="./Application/Home/View/Index/header_navbar.html"/>

<include file="./Application/Home/View/Index/side_left.html"/>
<div id="content" class="col-sm-11">
        <!--<div class="col-md-3 col-xs-6">-->
            <!--<div class="box bg-info">-->
                <!--<div class="box-header">-->
                    <!--<h2><span class="break"></span>管理用户数量</h2>-->
                    <!--<div class="box-icon">-->
                        <!--<a href="ui-nestable-list.html#" class="btn-minimize"><i class="fa fa-chevron-up"></i></a>-->
                        <!--<a href="ui-nestable-list.html#" class="btn-close"><i class="fa fa-times"></i></a>-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="box-content align-center">-->
                    <!--<h3><sup style="font-size: 20px">7位用户</sup>-->
                    <!--</h3>-->
                    <!--<p>-->
                        <!--&nbsp;-->
                    <!--</p>-->
                    <!--<div class="col-md-2 col-xs-2"><i class="fa fa-fw fa-users" style="font-size: 20px"></i></div>-->
                <!--<a href="#" onclick="return openPage('/user/userlist?spm=-1')" class="box-footer">用户列表<i class="fa fa-arrow-circle-right"></i></a>-->
                    <!--<br>-->
            <!--</div>-->
            <!--</div>-->
        <!--</div>-->
    <div class="row">
        <div class="col-md-3 col-xs-6">
            <!-- small box -->
            <div class="box">
                <div class="box-header">
                    <h2><span class="break"></span>设备管理</h2>
                    <div class="box-icon">
                        <a href="ui-nestable-list.html#" class="btn-minimize"><i class="fa fa-chevron-up"></i></a>
                        <a href="ui-nestable-list.html#" class="btn-close"><i class="fa fa-times"></i></a>
                    </div>
                </div>
                <div class="box-content">
                <div class="inner">
                    <h3><span id="device-count"></span><sup style="font-size: 20px">{$num_all}台设备</sup>
                    </h3>
                    <p>
                        在线<span id="device-online">{$num_online}</span>台，离线<span id="device-offline">{$num_offline}</span>台
                    </p>
                </div>
                    <div class="col-md-2 col-xs-2"><i class="fa fa-fw fa-server" style="font-size: 20px"></i></div>
                <a href="#" onclick="{location.href='mine_devices'}" class="small-box-footer">我要管理<i class="fa fa-arrow-circle-right"></i></a>
            </div>
            </div>
        </div>
        <div class="col-md-3 col-xs-6">
            <!-- small box -->

            <div class="box">
                <div class="box-header">
                    <h2><span class="break"></span>历史收录总数据量</h2>
                    <div class="box-icon">
                        <a href="ui-nestable-list.html#" class="btn-minimize"><i class="fa fa-chevron-up"></i></a>
                        <a href="ui-nestable-list.html#" class="btn-close"><i class="fa fa-times"></i></a>
                    </div>
                </div>
                <div class="box-content">
                <div class="inner">
                    <h3><sup style="font-size: 20px">{$data_num}万条</sup>
                    </h3>
                    <p>
                        &nbsp;
                    </p>
                </div>
                    <div class="col-md-2 col-xs-2"><i class="fa fa-fw fa-database" style="font-size: 20px"></i></div>
                <a href="#" onclick="{location.href='mine_rawdata'}" class="small-box-footer">我要查看<i class="fa fa-arrow-circle-right"></i></a>
            </div>
            </div>
        </div>
        <div class="col-md-3 col-xs-6">
            <!-- small box -->
            <div class="box">
                <div class="box-header">
                    <h2><span class="break"></span>监测数据</h2>
                    <div class="box-icon">
                        <a href="ui-nestable-list.html#" class="btn-minimize"><i class="fa fa-chevron-up"></i></a>
                        <a href="ui-nestable-list.html#" class="btn-close"><i class="fa fa-times"></i></a>
                    </div>
                </div>
                <div class="box-content">
                    <div style="text-align: center;font-weight: bold;">
                        <h2><strong>温度&nbsp;&nbsp;PM2.5&nbsp;&nbsp;光照</strong></h2>
                        <h2><strong>湿度&nbsp;&nbsp;PM10&nbsp;&nbsp;&nbsp;雨水</strong></h2>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3 col-xs-6">
            <div class="box" style="text-align: center">
                <img src="/Public/static/logo.jpg?id=1" style="height: 160px">
            </div>
        </div>
    </div>
        <div class="row">
        <volist name="data" id="vo" key="k">
        <div class="col-md-6">
            <div class="box">
                <div class="box-header">
                    <h2><i class="fa fa-list"></i><span class="break"></span>{$vo.detail}</h2>
                    <div class="box-icon">
                        <a href="charts-others.html#" class="btn-setting"><i class="fa fa-wrench"></i></a>
                        <a href="charts-others.html#" class="btn-minimize"><i class="fa fa-chevron-up"></i></a>
                        <a href="charts-others.html#" class="btn-close"><i class="fa fa-times"></i></a>
                    </div>
                </div>
                <div class="box-content" style="">
                    <div class="row">
                        <div id="main{$vo.id}" style="width: 700px;height:400px;"></div>
                    </div>
                </div>
            </div>
        </div>
        </volist>
        <div class="col-md-6">
            <div class="box">
                <div class="box-header">
                    <h2><i class="fa fa-list"></i><span class="break"></span>PM2.5浓度占比</h2>
                    <div class="box-icon">
                        <a href="charts-others.html#" class="btn-setting"><i class="fa fa-wrench"></i></a>
                        <a href="charts-others.html#" class="btn-minimize"><i class="fa fa-chevron-up"></i></a>
                        <a href="charts-others.html#" class="btn-close"><i class="fa fa-times"></i></a>
                    </div>
                </div>
                <div class="box-content" style="">
                    <div class="row">
                        <div id="main_percent_pm25" style="width: 700px;height:400px;"></div>
                    </div>
                </div>
        </div>
        </div>
            <div class="col-md-6">
                <div class="box">
                    <div class="box-header">
                        <h2><i class="fa fa-list"></i><span class="break"></span>PM10浓度占比</h2>
                        <div class="box-icon">
                            <a href="charts-others.html#" class="btn-setting"><i class="fa fa-wrench"></i></a>
                            <a href="charts-others.html#" class="btn-minimize"><i class="fa fa-chevron-up"></i></a>
                            <a href="charts-others.html#" class="btn-close"><i class="fa fa-times"></i></a>
                        </div>
                    </div>
                    <div class="box-content" style="">
                        <div class="row">
                            <div id="main_percent_pm10" style="width: 700px;height:400px;"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="box">
                    <div class="box-header">
                        <h2><i class="fa fa-list"></i><span class="break"></span>温度气泡图</h2>
                        <div class="box-icon">
                            <a href="charts-others.html#" class="btn-setting"><i class="fa fa-wrench"></i></a>
                            <a href="charts-others.html#" class="btn-minimize"><i class="fa fa-chevron-up"></i></a>
                            <a href="charts-others.html#" class="btn-close"><i class="fa fa-times"></i></a>
                        </div>
                    </div>
                    <div class="box-content" style="">
                        <div class="row">
                            <div id="calendar_heat" style="width: 700px;height:400px;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

<include file="./Application/Home/View/Index/js_new_end.html"/>
<import file="asserts_new.js.raphael#min"/>
<import file="asserts_new.js.justgage#1#0#1#min"/>
<import file="javascript.echarts#min"/>
<volist name="data" id="vo" key="k">
<script type="text/javascript">
    var myChart = echarts.init(document.getElementById('main{$vo.id}'));
    labelTop = {
        normal : {
            label : {
                show : true,
                position : 'center',
                formatter : '{b}',
                textStyle: {
                    baseline : 'bottom'
                }
            },
            labelLine : {
                show : false
            }
        }
    };
    var labelFromatter = {
        normal : {
            label : {
                formatter : function (params){
                    return 100 - params.value + '%'
                },
                textStyle: {
                    baseline : 'top'
                }
            }
        },
    }
    var labelBottom = {
        normal : {
            color: '#ccc',
            label : {
                show : true,
                position : 'center'
            },
            labelLine : {
                show : false
            }
        },
        emphasis: {
            color: 'rgba(0,0,0,0)'
        }
    };
    var radius = [40, 55];
    option = {
        legend: {
            x : 'center',
            y : 'center',
            data:[
                '温度', '湿度', 'PM2.5', 'PM10'
            ]
        },
        title : {
            text: '监测点主要数据',
            x: 'center'
        },
        series : [
            {
                type : 'pie',
                center : ['20%', '30%'],
                radius : radius,
                x: '0%', // for funnel
                itemStyle : labelFromatter,
                data : [
                    {name:'other', value:100-{$vo.temp}, itemStyle : labelBottom},
                    {name:'温度', value:{$vo.temp},itemStyle : labelTop}
                ]
            },
            {
                type : 'pie',
                center : ['40%', '30%'],
                radius : radius,
                x:'20%', // for funnel
                itemStyle : labelFromatter,
                data : [
                    {name:'other', value:100-{$vo.humidity}, itemStyle : labelBottom},
                    {name:'湿度', value:{$vo.humidity},itemStyle : labelTop}
                ]
            },
            {
                type : 'pie',
                center : ['60%', '30%'],
                radius : radius,
                x:'40%', // for funnel
                itemStyle : labelFromatter,
                data : [
                    {name:'other', value:100-parseInt({$vo.pm25}/10), itemStyle : labelBottom},
                    {name:'PM2.5', value:parseInt({$vo.pm25}/10),itemStyle : labelTop}
                ]
            },
            {
                type : 'pie',
                center : ['80%', '30%'],
                radius : radius,
                x:'60%', // for funnel
                itemStyle : labelFromatter,
                data : [
                    {name:'other', value:100-parseInt({$vo.pm10}/10), itemStyle : labelBottom},
                    {name:'PM10', value:parseInt({$vo.pm10}/10),itemStyle : labelTop}
                ]
            }
        ]
    };
    myChart.setOption(option);
</script>
</volist>
<script type="text/javascript">
    var myChart = echarts.init(document.getElementById('main_percent_pm25'));
    option = {
        title : {
            text: '各监测点PM2.5浓度占比',
            x:'center'
        },
        tooltip : {
            trigger: 'item',
            formatter: "{a} <br/>{b} : {c} ({d}%)"
        },
        legend: {
            orient: 'vertical',
            left: 'left',
            data: ['监测点1','监测点2','监测点3']
        },
        series : [
            {
                name: '访问来源',
                type: 'pie',
                radius : '55%',
                center: ['50%', '40%'],
                data:[
                    {value:335, name:'监测点1'},
                    {value:310, name:'监测点2'},
                    {value:234, name:'监测点3'},
                ],
                itemStyle: {
                    emphasis: {
                        shadowBlur: 10,
                        shadowOffsetX: 0,
                        shadowColor: 'rgba(0, 0, 0, 0.5)'
                    }
                }
            }
        ]
    };
    myChart.setOption(option);
</script>
    <script type="text/javascript">
        var myChart = echarts.init(document.getElementById('main_percent_pm10'));
        option = {
            title : {
                text: '各监测点PM10浓度占比',
                x:'center'
            },
            tooltip : {
                trigger: 'item',
                formatter: "{a} <br/>{b} : {c} ({d}%)"
            },
            legend: {
                orient: 'vertical',
                left: 'left',
                data: ['监测点1','监测点2','监测点3']
            },
            series : [
                {
                    name: '访问来源',
                    type: 'pie',
                    radius : '55%',
                    center: ['50%', '40%'],
                    data:[
                        {value:212, name:'监测点1'},
                        {value:210, name:'监测点2'},
                        {value:234, name:'监测点3'},
                    ],
                    itemStyle: {
                        emphasis: {
                            shadowBlur: 10,
                            shadowOffsetX: 0,
                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                        }
                    }
                }
            ]
        };
        myChart.setOption(option);
    </script>
    <script type="text/javascript">
        var myChart = echarts.init(document.getElementById('calendar_heat'));
        function getVirtulData(year) {
            year = year || '2017';
            var date = +echarts.number.parseDate(year + '-01-01');
            var end = +echarts.number.parseDate((+year + 1) + '-01-01');
            var dayTime = 3600 * 24 * 1000;
            var data = [];
            for (var time = date; time < end; time += dayTime) {
                data.push([
                    echarts.format.formatTime('yyyy-MM-dd', time),
                    Math.floor(Math.random() * 400)
                ]);
            }
            console.log(data[data.length - 1]);
            return data;
        }
        option = {
            tooltip: {
                position: 'top'
            },

            visualMap: [{
                min: 0,
                max: 40,
                calculable: true,
                seriesIndex: [0],
                orient: 'horizontal',
                left: '35%',
                bottom: 20
            }],

            calendar: [
                {
                    orient: 'vertical',
                    yearLabel: {
                        margin: 40
                    },
                    monthLabel: {
                        margin: 20
                    },
                    cellSize: 40,
                    left: 300,
                    range: '2017-10'
                }],

            series: [{
                type: 'effectScatter',
                coordinateSystem: 'calendar',
                calendarIndex: 0,
                symbolSize: function (val) {
                    return val[1] / 40;
                },
                data: getVirtulData(2017)
            }]
        };
        myChart.setOption(option);
    </script>
</body>
</html>